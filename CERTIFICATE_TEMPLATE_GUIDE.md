# 🎓 Certificate Template Creation Guide

## 📋 **Overview**
This guide will help you create a Microsoft Word certificate template for ex-students that can be dynamically populated with student data and QR codes.

## 🎯 **Template Requirements**

### **Dynamic Fields Needed:**
- Student Name
- Course/Program Name
- Graduation Date
- Certificate Number
- QR Code (generated by system)

## 📝 **Step-by-Step Template Creation**

### **Step 1: Open Microsoft Word**
1. Open Microsoft Word
2. Create a new document
3. Set page orientation to **Portrait**
4. Set page size to **A4** (210mm x 297mm)

### **Step 2: Design the Certificate Layout**

#### **Header Section:**
```
[OLYMPIA COLLEGE MALAYSIA LOGO/CREST]
[College Name: OLYMPIA COLLEGE MALAYSIA]
```

#### **Main Content:**
```
Bachelor of Science

This is to certify that

[STUDENT_NAME]

has been awarded the

[COURSE_NAME]

having fulfilled the requirements prescribed by the Academic Board, 
and with the assent of the Examination Board. 
Witness our hand and seal this

[GRADUATION_DATE]
```

#### **Footer Section:**
```
[Director Signature]          [Chairman Signature]          [Registrar Signature]
Director                     Chairman                       Registrar
Olympia College              Olympia Academic Board         Olympia Examination Board

[RED WAX SEAL]              Certificate No: [CERTIFICATE_NUMBER]
                            [QR_CODE_PLACEHOLDER]
```

### **Step 3: Insert Placeholder Fields**

#### **Method 1: Using Word Mail Merge Fields**
1. Go to **Mailings** tab
2. Click **Insert Merge Field**
3. Create these fields:
   - `STUDENT_NAME`
   - `COURSE_NAME` 
   - `GRADUATION_DATE`
   - `CERTIFICATE_NUMBER`

#### **Method 2: Using Custom Placeholders**
Use these exact placeholders in your template:
- `{{STUDENT_NAME}}`
- `{{COURSE_NAME}}`
- `{{GRADUATION_DATE}}`
- `{{CERTIFICATE_NUMBER}}`
- `{{QR_CODE}}`

### **Step 4: QR Code Integration**

#### **Option A: Placeholder for QR Code Image**
1. Insert a **Rectangle** shape where you want the QR code
2. Set size: **2cm x 2cm** (or as needed)
3. Add placeholder text: `[QR_CODE_HERE]`
4. Position it below the certificate number

#### **Option B: Using Word's QR Code Feature**
1. Go to **Insert** → **Text** → **Object**
2. Choose **Microsoft Word Document**
3. Insert placeholder: `{{QR_CODE}}`

## 🔧 **Laravel Integration Code**

### **Certificate Generation Controller**

Create `app/Http/Controllers/CertificateController.php`:

```php
<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\Storage;
use SimpleSoftwareIO\QrCode\Facades\QrCode;
use PhpOffice\PhpWord\TemplateProcessor;

class CertificateController extends Controller
{
    public function generateCertificate($studentId)
    {
        // Get student data
        $student = \App\Models\User::find($studentId);
        
        if (!$student) {
            return response()->json(['error' => 'Student not found'], 404);
        }

        // Generate QR Code
        $qrCodeData = [
            'student_name' => $student->name,
            'certificate_number' => $student->certificate_number ?? 'CERT-' . time(),
            'course' => $student->programme_name,
            'graduation_date' => $student->graduation_date ?? now()->format('d F Y'),
            'verification_url' => url('/verify-certificate/' . $student->certificate_number)
        ];

        // Generate QR Code
        $qrCode = QrCode::format('png')
            ->size(200)
            ->generate(json_encode($qrCodeData));

        // Save QR Code temporarily
        $qrCodePath = 'temp/qr_' . $student->id . '.png';
        Storage::disk('public')->put($qrCodePath, $qrCode);

        // Process Word template
        $templatePath = storage_path('app/templates/certificate_template.docx');
        $templateProcessor = new TemplateProcessor($templatePath);

        // Replace placeholders
        $templateProcessor->setValue('STUDENT_NAME', $student->name);
        $templateProcessor->setValue('COURSE_NAME', $student->programme_name);
        $templateProcessor->setValue('GRADUATION_DATE', $student->graduation_date ?? now()->format('d F Y'));
        $templateProcessor->setValue('CERTIFICATE_NUMBER', $student->certificate_number ?? 'CERT-' . time());

        // Replace QR Code (if using image placeholder)
        $templateProcessor->setImageValue('QR_CODE', [
            'path' => storage_path('app/public/' . $qrCodePath),
            'width' => 200,
            'height' => 200
        ]);

        // Generate final certificate
        $certificatePath = 'certificates/certificate_' . $student->id . '_' . time() . '.docx';
        $templateProcessor->saveAs(storage_path('app/public/' . $certificatePath));

        // Clean up temporary QR code
        Storage::disk('public')->delete($qrCodePath);

        return response()->download(storage_path('app/public/' . $certificatePath));
    }
}
```

### **Required Packages**

Install these packages:

```bash
composer require phpoffice/phpword
composer require simplesoftwareio/simple-qrcode
```

### **Database Migration for Certificate Data**

```php
// Create migration: php artisan make:migration add_certificate_fields_to_users_table

public function up()
{
    Schema::table('users', function (Blueprint $table) {
        $table->string('certificate_number')->nullable();
        $table->date('graduation_date')->nullable();
        $table->boolean('certificate_generated')->default(false);
    });
}
```

## 📁 **File Structure Setup**

### **Template Storage:**
```
storage/
├── app/
│   ├── templates/
│   │   └── certificate_template.docx
│   └── public/
│       ├── certificates/
│       └── temp/
```

### **Steps to Set Up:**
1. Create the directories:
```bash
mkdir -p storage/app/templates
mkdir -p storage/app/public/certificates
mkdir -p storage/app/public/temp
```

2. Copy your Word template to `storage/app/templates/certificate_template.docx`

## 🎨 **Template Design Tips**

### **Fonts and Styling:**
- **Main Title**: Times New Roman, 24pt, Bold
- **Student Name**: Script font, 20pt, Elegant
- **Course Name**: Times New Roman, 16pt, Italic
- **Body Text**: Times New Roman, 12pt, Regular
- **Certificate Number**: Arial, 10pt, Bold

### **Layout Guidelines:**
- **Margins**: 2cm on all sides
- **Header**: 15% of page height
- **Main Content**: 60% of page height
- **Footer**: 25% of page height
- **QR Code**: 2cm x 2cm, positioned below certificate number

## 🔄 **Dynamic Data Integration**

### **Word Template Placeholders:**
Replace static text with these placeholders:

```xml
<!-- In your Word template -->
{{STUDENT_NAME}}
{{COURSE_NAME}}
{{GRADUATION_DATE}}
{{CERTIFICATE_NUMBER}}
{{QR_CODE}}
```

### **QR Code Content:**
The QR code will contain:
```json
{
    "student_name": "Student Name",
    "certificate_number": "CERT-123456",
    "course": "Bachelor of Science (Hons) in ICT",
    "graduation_date": "10 June 2019",
    "verification_url": "https://lms.olympia-education.com/verify-certificate/CERT-123456"
}
```

## 🚀 **Testing the Template**

### **Test Steps:**
1. Create a test student in your database
2. Generate a certificate using the controller
3. Verify all placeholders are replaced correctly
4. Check QR code functionality
5. Test certificate download

### **Verification Endpoint:**
Create a route to verify certificates:
```php
Route::get('/verify-certificate/{certificateNumber}', function($certificateNumber) {
    $student = \App\Models\User::where('certificate_number', $certificateNumber)->first();
    
    if ($student) {
        return view('certificate.verify', compact('student'));
    }
    
    return view('certificate.invalid');
});
```

## 📋 **Next Steps**

1. **Create the Word template** with placeholders
2. **Install required packages**
3. **Set up the file structure**
4. **Create the certificate controller**
5. **Test with sample data**
6. **Integrate with your ex-students feature**

This template will allow you to generate professional certificates for all ex-students with their specific data and QR codes for verification!

